OBJECT Page 26 Vendor Card
{
  OBJECT-PROPERTIES
  {
    Date=24/02/17;
    Time=14:31:11;
    Modified=Yes;
    Version List=NAVW110.0,HelloWorld;
  }
  PROPERTIES
  {
    CaptionML=ENU=Vendor Card;
    SourceTable=Table23;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=ENU=New,Process,Report,Approve,Request Approval,New Document,Navigate,Incoming Documents;
    OnInit=BEGIN
             SetVendorNoVisibilityOnFactBoxes;

             ContactEditable := TRUE;
             IF "No." <> '' THEN
               CurrPage.AgedAccPayableChart.PAGE.SetPerVendor;
           END;

    OnOpenPage=BEGIN
                 ActivateFields;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;
                     END;

    OnNewRecord=VAR
                  DocumentNoVisibility@1003 : Codeunit 1400;
                BEGIN
                  IF GUIALLOWED THEN
                    IF "No." = '' THEN
                      IF DocumentNoVisibility.VendorNoSeriesIsDefault THEN
                        NewMode := TRUE;
                END;

    OnAfterGetCurrRecord=BEGIN
                           CreateVendorFromTemplate;
                           ActivateFields;
                           OpenApprovalEntriesExistCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
                           OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 64      ;1   ;ActionGroup;
                      CaptionML=ENU=Ven&dor;
                      Image=Vendor }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      ToolTipML=ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                      ApplicationArea=#Suite;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(23),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 87      ;2   ;Action    ;
                      CaptionML=ENU=Bank Accounts;
                      ToolTipML=ENU=View or set up the vendor's bank accounts. You can set up any number of bank accounts for each vendor.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 426;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=BankAccount }
      { 14      ;2   ;Action    ;
                      Name=ContactBtn;
                      AccessByPermission=TableData 5050=R;
                      CaptionML=ENU=C&ontact;
                      ToolTipML=ENU=View or edit detailed information about the contact person at the customer.;
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=ContactPerson;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Name=OrderAddresses;
                      CaptionML=ENU=Order &Addresses;
                      ToolTipML=ENU=View a list of alternate order addresses for the vendor.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 369;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Addresses }
      { 68      ;2   ;Action    ;
                      CaptionML=ENU=Co&mments;
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Vendor),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 76      ;2   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData 454=R;
                      CaptionML=ENU=Approvals;
                      ToolTipML=ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 84      ;2   ;Action    ;
                      CaptionML=ENU=Cross References;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5723;
                      RunPageView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunPageLink=Cross-Reference Type=CONST(Vendor),
                                  Cross-Reference Type No.=FIELD(No.);
                      Image=Change }
      { 225     ;2   ;Action    ;
                      Name=VendorReportSelections;
                      CaptionML=ENU=Document Layouts;
                      ToolTipML=ENU=Set up a layout for different types of documents such as invoices, quotes, and credit memos.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Quote;
                      OnAction=VAR
                                 CustomReportSelection@1001 : Record 9657;
                               BEGIN
                                 CustomReportSelection.SETRANGE("Source Type",DATABASE::Vendor);
                                 CustomReportSelection.SETRANGE("Source No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Vendor Report Selections",CustomReportSelection);
                               END;
                                }
      { 71      ;1   ;ActionGroup;
                      CaptionML=ENU=&Purchases;
                      Image=Purchasing }
      { 118     ;2   ;Action    ;
                      CaptionML=ENU=Items;
                      RunObject=Page 297;
                      RunPageView=SORTING(Vendor No.,Item No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Item }
      { 73      ;2   ;Action    ;
                      CaptionML=ENU=Invoice &Discounts;
                      ToolTipML=ENU=View or set up conditions for invoice discounts and service charges for the vendor.;
                      ApplicationArea=#Suite;
                      RunObject=Page 28;
                      RunPageLink=Code=FIELD(Invoice Disc. Code);
                      Image=CalculateInvoiceDiscount }
      { 72      ;2   ;Action    ;
                      CaptionML=ENU=Prices;
                      ToolTipML=ENU=View or set up different prices for items that you buy from the vendor. An item price is automatically granted on invoice lines when the specified criteria are met, such as vendor, quantity, or ending date.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7012;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Price }
      { 116     ;2   ;Action    ;
                      CaptionML=ENU=Line Discounts;
                      ToolTipML=ENU=View or set up purchase line discounts.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7014;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=LineDiscount }
      { 129     ;2   ;Action    ;
                      CaptionML=ENU=Prepa&yment Percentages;
                      RunObject=Page 665;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=PrepaymentPercentages }
      { 123     ;2   ;Action    ;
                      CaptionML=ENU=S&td. Vend. Purchase Codes;
                      RunObject=Page 178;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=CodesList }
      { 78      ;2   ;Action    ;
                      CaptionML=ENU=Mapping Text to Account;
                      ToolTipML=ENU=Page mapping text to account;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1254;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=MapAccounts }
      { 5       ;1   ;ActionGroup;
                      CaptionML=ENU=Documents;
                      Image=Administration }
      { 74      ;2   ;Action    ;
                      CaptionML=ENU=Quotes;
                      RunObject=Page 9306;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 75      ;2   ;Action    ;
                      CaptionML=ENU=Orders;
                      RunObject=Page 9307;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 99      ;2   ;Action    ;
                      CaptionML=ENU=Return Orders;
                      RunObject=Page 9311;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=ReturnOrder }
      { 21      ;2   ;Action    ;
                      CaptionML=ENU=Blanket Orders;
                      RunObject=Page 9310;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 7       ;1   ;ActionGroup;
                      CaptionML=ENU=History;
                      Image=History }
      { 70      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Ledger E&ntries;
                      ToolTipML=ENU=View the history of transactions that have been posted for the selected record.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 29;
                      RunPageView=SORTING(Vendor No.)
                                  ORDER(Descending);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 66      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      RunObject=Page 152;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 69      ;2   ;Action    ;
                      CaptionML=ENU=Purchases;
                      RunObject=Page 156;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=Purchase }
      { 67      ;2   ;Action    ;
                      CaptionML=ENU=Entry Statistics;
                      RunObject=Page 303;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=EntryStatistics }
      { 20      ;2   ;Action    ;
                      CaptionML=ENU=Statistics by C&urrencies;
                      RunObject=Page 487;
                      RunPageLink=Vendor Filter=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter);
                      Image=Currencies }
      { 6500    ;2   ;Action    ;
                      CaptionML=ENU=Item &Tracking Entries;
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingDocMgt@1000 : Codeunit 6503;
                               BEGIN
                                 ItemTrackingDocMgt.ShowItemTrackingForMasterData(2,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      Name=NewBlanketPurchaseOrder;
                      CaptionML=ENU=Blanket Purchase Order;
                      RunObject=Page 509;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1901469405;1 ;Action    ;
                      Name=NewPurchaseQuote;
                      CaptionML=ENU=Purchase Quote;
                      RunObject=Page 49;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1907709505;1 ;Action    ;
                      Name=NewPurchaseInvoice;
                      CaptionML=ENU=Purchase Invoice;
                      ToolTipML=ENU=Create a new purchase invoice for items or services.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 51;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=NewPurchaseInvoice;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1907375405;1 ;Action    ;
                      Name=NewPurchaseOrder;
                      CaptionML=ENU=Purchase Order;
                      ToolTipML=ENU=Create a new purchase order.;
                      ApplicationArea=#Suite;
                      RunObject=Page 50;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1905024805;1 ;Action    ;
                      Name=NewPurchaseCrMemo;
                      CaptionML=ENU=Purchase Credit Memo;
                      ToolTipML=ENU=Create a new purchase credit memo to revert a posted purchase invoice.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 52;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1904749705;1 ;Action    ;
                      Name=NewPurchaseReturnOrder;
                      CaptionML=ENU=Purchase Return Order;
                      RunObject=Page 6640;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 86401   ;1   ;Action    ;
                      Name=Say Hello World;
                      Image=Web }
      { 39      ;1   ;ActionGroup;
                      CaptionML=ENU=Approval }
      { 37      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=ENU=Approve;
                      ToolTipML=ENU=Approve the requested changes.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 35      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=ENU=Reject;
                      ToolTipML=ENU=Reject the approval request.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=ENU=Delegate;
                      ToolTipML=ENU=Delegate the approval to a substitute approver.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 77      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=ENU=Comments;
                      ToolTipML=ENU=View or add comments.;
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      CaptionML=ENU=Request Approval;
                      Image=SendApprovalRequest }
      { 29      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=ENU=Send A&pproval Request;
                      ToolTipML=ENU=Send an approval request.;
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckVendorApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendVendorForApproval(Rec);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=ENU=Cancel Approval Re&quest;
                      ToolTipML=ENU=Cancel the approval request.;
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelVendorApprovalRequest(Rec);
                               END;
                                }
      { 130     ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 59      ;2   ;Action    ;
                      Name=Templates;
                      CaptionML=ENU=Templates;
                      ToolTipML=ENU=View or edit vendor templates.;
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1340;
                      RunPageLink=Table ID=CONST(23);
                      PromotedIsBig=Yes;
                      Image=Template }
      { 131     ;2   ;Action    ;
                      Name=ApplyTemplate;
                      Ellipsis=Yes;
                      CaptionML=ENU=Apply Template;
                      ToolTipML=ENU=Cancel the approval request.;
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MiniVendorTemplate@1002 : Record 1303;
                               BEGIN
                                 MiniVendorTemplate.UpdateVendorFromTemplate(Rec);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=SaveAsTemplate;
                      Ellipsis=Yes;
                      CaptionML=ENU=Save as Template;
                      ToolTipML=ENU=Save the vendor card as a template that can be reused to create new vendor cards. Vendor templates contain preset information to help you fill fields on vendor cards.;
                      ApplicationArea=#Basic,#Suite;
                      Image=Save;
                      OnAction=VAR
                                 TempMiniVendorTemplate@1000 : TEMPORARY Record 1303;
                               BEGIN
                                 TempMiniVendorTemplate.SaveAsTemplate(Rec);
                               END;
                                }
      { 1902327104;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Payments;
                      ToolTipML=ENU=View or edit the payment journal where you can register payments to vendors.;
                      RunObject=Page 256;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=ENU=Purchase Journal;
                      RunObject=Page 254;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 63      ;1   ;ActionGroup;
                      CaptionML=ENU=Incoming Documents;
                      Image=SendApprovalRequest }
      { 65      ;2   ;Action    ;
                      Name=SendToIncomingDocuments;
                      Ellipsis=Yes;
                      CaptionML=ENU=Send to Incoming Documents;
                      ToolTipML=ENU=Send to Incoming Documents;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendToIncomingDocumentVisible;
                      Enabled=SendToIncomingDocEnabled;
                      PromotedIsBig=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendToIncomingDocuments("No.");
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Name=SendToOCR;
                      Ellipsis=Yes;
                      CaptionML=ENU=Send To OCR;
                      ToolTipML=ENU=Send To OCR;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendToOCRVisible;
                      Enabled=SendToOCREnabled;
                      PromotedIsBig=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendToOCR("No.");
                               END;
                                }
      { 62      ;2   ;Action    ;
                      Name=SendIncomingDocApprovalRequest;
                      AccessByPermission=TableData 454=I;
                      CaptionML=ENU=Send A&pproval Request;
                      ToolTipML=ENU=Send an approval request.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendIncomingDocApprovalRequestVisible;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendApprovalRequest("No.");
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 57      ;1   ;Action    ;
                      CaptionML=ENU=Vendor - Summary Aging;
                      ToolTipML=ENU=View a summary of the payables owed to each vendor, divided into three time periods.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Summary Aging");
                               END;
                                }
      { 1905916106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Labels;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Labels");
                               END;
                                }
      { 1904504206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Balance to Date;
                      ToolTipML=ENU=View a detail balance for selected vendors.;
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Balance to Date");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number of the vendor. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.;
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=NoFieldVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's name. You can enter a maximum of 30 characters, both numbers and letters.;
                ApplicationArea=#All;
                SourceExpr=Name;
                Importance=Promoted;
                ShowMandatory=TRUE }

    { 24  ;2   ;Field     ;
                ToolTipML=ENU=Specifies which transactions with the vendor that cannot be posted.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Blocked }

    { 26  ;2   ;Field     ;
                ToolTipML=ENU=Specifies when the vendor card was last modified.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 92  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the total value of your completed purchases from the vendor in the current fiscal year. It is calculated from amounts excluding VAT on all completed purchase invoices and credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)";
                OnDrillDown=BEGIN
                              OpenVendorLedgerEntries(FALSE);
                            END;
                             }

    { 45  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the total value of your unpaid purchases from the vendor in the current fiscal year. It is calculated from amounts excluding VAT on all open purchase invoices and credit memos.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance Due (LCY)";
                OnDrillDown=BEGIN
                              OpenVendorLedgerEntries(TRUE);
                            END;
                             }

    { 80  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the preferred method of sending documents to this vendor, so that you do not have to select a sending option every time that you post and send a document to the vendor. Documents to this vendor will be sent using the specified sending profile and will override the default document sending profile.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Sending Profile";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                ToolTipML=ENU=Specifies a search name.;
                SourceExpr="Search Name";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                ToolTipML=ENU=Specifies a code to specify the purchaser who normally handles this vendor's account.;
                SourceExpr="Purchaser Code";
                Importance=Additional }

    { 55  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the code for the responsibility center that will administer this vendor by default.;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 1902768601;1;Group  ;
                CaptionML=ENU=Address & Contact;
                GroupType=Group }

    { 43  ;2   ;Group     ;
                CaptionML=ENU=Address;
                GroupType=Group }

    { 6   ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Address }

    { 8   ;3   ;Field     ;
                ToolTipML=ENU=Specifies additional address information.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Address 2" }

    { 79  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the postal code.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 10  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's city.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=City }

    { 81  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the country/region of the address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code" }

    { 49  ;3   ;Field     ;
                Name=ShowMap;
                ToolTipML=ENU=Specifies you can view the customer's address on your preferred map website.;
                SourceExpr=ShowMapLbl;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.UPDATE(TRUE);
                              DisplayMap;
                            END;

                ShowCaption=No }

    { 44  ;2   ;Group     ;
                CaptionML=ENU=Contact;
                GroupType=Group }

    { 11  ;3   ;Field     ;
                CaptionML=ENU=Primary Contact Code;
                ToolTipML=ENU=Specifies the primary contact number for the customer.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Primary Contact No." }

    { 16  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the name of the person you regularly contact when you do business with this vendor.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 12  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's telephone number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No." }

    { 48  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's email address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 58  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the customer's fax number.;
                SourceExpr="Fax No.";
                Importance=Additional }

    { 86  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's home page address.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Home Page" }

    { 50  ;3   ;Field     ;
                ToolTipML=ENU=Specifies your account number with the vendor, if you have one.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Our Account No." }

    { 1905885101;1;Group  ;
                CaptionML=ENU=Invoicing }

    { 23  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's VAT registration number.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Registration No.";
                OnDrillDown=VAR
                              VATRegistrationLogMgt@1000 : Codeunit 249;
                            BEGIN
                              VATRegistrationLogMgt.AssistEditVendorVATReg(Rec);
                            END;
                             }

    { 25  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the vendor in connection with electronic document receiving.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN;
                Importance=Additional }

    { 30  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the number of a different vendor whom you pay for products delivered by the vendor on the vendor card.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Vendor No.";
                Importance=Additional }

    { 34  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's invoice discount code. When you set up a new vendor card, the number you have entered in the No. field is automatically inserted.;
                ApplicationArea=#Basic,#Suite;
                NotBlank=Yes;
                SourceExpr="Invoice Disc. Code";
                Importance=Additional }

    { 94  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the Direct Unit Cost and Line Amount fields on the purchase lines and in purchase reports should be shown with or without VAT.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT" }

    { 46  ;2   ;Group     ;
                CaptionML=ENU=Posting Details;
                GroupType=Group }

    { 60  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's trade type to link transactions made for this vendor with the appropriate general ledger account according to the general posting setup.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 90  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's VAT specification to link transactions made for this vendor with the appropriate general ledger account according to the VAT posting setup.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                Importance=Additional }

    { 32  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the vendor's market type to link business transactions made for the vendor with the appropriate account in the general ledger.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 47  ;2   ;Group     ;
                CaptionML=ENU=Foreign Trade;
                GroupType=Group }

    { 52  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the currency code that is inserted by default when you create purchase documents or journal lines for the vendor.;
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Additional }

    { 56  ;3   ;Field     ;
                ToolTipML=ENU=Specifies the language on printouts for this vendor.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Importance=Additional }

    { 1901677601;1;Group  ;
                CaptionML=ENU=Payments }

    { 36  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how to apply payments to entries for this vendor.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Application Method" }

    { 38  ;2   ;Field     ;
                ToolTipML=ENU=Specifies a code that indicates the payment terms that the vendor usually requires.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how the vendor requires you to submit payment, such as bank transfer or check.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                ToolTipML=ENU=Specifies the importance of the vendor when suggesting payments using the Suggest Vendor Payments function.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Priority }

    { 119 ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the vendor allows payment tolerance.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolVendLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolVendLedgEntry(Rec);
                             END;
                           END;
                            }

    { 9   ;2   ;Field     ;
                ToolTipML=ENU=Specifies the vendor bank account that will be used by default on payment journal lines for export to a payment bank file.;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Preferred Bank Account Code" }

    { 15  ;2   ;Field     ;
                ToolTipML=ENU=Specifies if the vendor is a person or a company.;
                SourceExpr="Partner Type" }

    { 3   ;2   ;Field     ;
                ToolTipML=ENU=Specifies a payment term that will be used for calculating cash flow.;
                SourceExpr="Cash Flow Payment Terms Code" }

    { 13  ;2   ;Field     ;
                ToolTipML=ENU=Identifies the vendor who sent the purchase invoice.;
                SourceExpr="Creditor No." }

    { 1901075901;1;Group  ;
                CaptionML=ENU=Receiving }

    { 100 ;2   ;Field     ;
                ToolTipML=ENU=Specifies the warehouse location where items from the vendor must be received by default.;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                ToolTipML=ENU=Specifies how the vendor must ship items to you.;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                ToolTipML=ENU=Specifies a date formula for the time that it takes to replenish the item.;
                SourceExpr="Lead Time Calculation";
                Importance=Promoted }

    { 112 ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=ENU=Specifies the code for the vendor's customized calendar.;
                SourceExpr="Base Calendar Code" }

    { 121 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=ENU=Customized Calendar;
                ToolTipML=ENU=Specifies if you have set up a customized calendar for the vendor.;
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 82  ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page786;
                Visible=NOT IsOfficeAddin;
                PartType=Page }

    { 1904651607;1;Part   ;
                Name=VendorStatisticsFactBox;
                ApplicationArea=#All;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9094;
                PartType=Page }

    { 53  ;1   ;Part      ;
                Name=AgedAccPayableChart;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page769;
                Visible=IsOfficeAddin;
                PartType=Page }

    { 17  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Vendor),
                            Source No.=FIELD(No.);
                PagePartID=Page875;
                Visible=SocialListeningVisible;
                PartType=Page }

    { 19  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Vendor),
                            Source No.=FIELD(No.);
                PagePartID=Page876;
                Visible=SocialListeningSetupVisible;
                PartType=Page;
                UpdatePropagation=Both }

    { 1903435607;1;Part   ;
                Name=VendorHistBuyFromFactBox;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                Name=VendorHistPayToFactBox;
                ApplicationArea=#All;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 41  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CustomizedCalEntry@1003 : Record 7603;
      CustomizedCalendar@1001 : Record 7602;
      OfficeMgt@1015 : Codeunit 1630;
      CalendarMgmt@1000 : Codeunit 7600;
      PaymentToleranceMgt@1002 : Codeunit 426;
      ApprovalsMgmt@1010 : Codeunit 1535;
      Text001@1005 : TextConst 'ENU=Do you want to allow payment tolerance for entries that are currently open?';
      Text002@1004 : TextConst 'ENU=Do you want to remove payment tolerance from entries that are currently open?';
      ContactEditable@19051436 : Boolean INDATASET;
      SocialListeningSetupVisible@1007 : Boolean INDATASET;
      SocialListeningVisible@1006 : Boolean INDATASET;
      OpenApprovalEntriesExistCurrUser@1009 : Boolean;
      OpenApprovalEntriesExist@1008 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      ShowMapLbl@1014 : TextConst 'ENU=Show on Map';
      IsOfficeAddin@1012 : Boolean;
      CanCancelApprovalForRecord@1013 : Boolean;
      SendToOCREnabled@1016 : Boolean;
      SendToOCRVisible@1017 : Boolean;
      SendToIncomingDocEnabled@1018 : Boolean;
      SendIncomingDocApprovalRequestVisible@1019 : Boolean;
      SendToIncomingDocumentVisible@1020 : Boolean;
      NoFieldVisible@1021 : Boolean;
      NewMode@1022 : Boolean;

    LOCAL PROCEDURE ActivateFields@3();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
    BEGIN
      SetSocialListeningFactboxVisibility;
      NoFieldVisible := DocumentNoVisibility.VendorNoIsVisible;
      ContactEditable := "Primary Contact No." = '';
      IF OfficeMgt.IsAvailable THEN
        ActivateIncomingDocumentsFields;
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE SetSocialListeningFactboxVisibility@1();
    VAR
      SocialListeningMgt@1000 : Codeunit 871;
    BEGIN
      SocialListeningMgt.GetVendFactboxVisibility(Rec,SocialListeningSetupVisible,SocialListeningVisible);
    END;

    LOCAL PROCEDURE SetVendorNoVisibilityOnFactBoxes@2();
    BEGIN
      CurrPage.VendorHistBuyFromFactBox.PAGE.SetVendorNoVisibility(FALSE);
      CurrPage.VendorHistPayToFactBox.PAGE.SetVendorNoVisibility(FALSE);
      CurrPage.VendorStatisticsFactBox.PAGE.SetVendorNoVisibility(FALSE);
    END;

    LOCAL PROCEDURE RunReport@4(ReportNumber@1000 : Integer);
    VAR
      Vendor@1001 : Record 23;
    BEGIN
      Vendor.SETRANGE("No.","No.");
      REPORT.RUNMODAL(ReportNumber,TRUE,TRUE,Vendor);
    END;

    LOCAL PROCEDURE ActivateIncomingDocumentsFields@11();
    VAR
      IncomingDocument@1001 : Record 130;
    BEGIN
      IF OfficeMgt.OCRAvailable THEN BEGIN
        SendToIncomingDocumentVisible := TRUE;
        SendToIncomingDocEnabled := OfficeMgt.EmailHasAttachments;
        SendToOCREnabled := OfficeMgt.EmailHasAttachments;
        SendToOCRVisible := IncomingDocument.OCRIsEnabled AND NOT IsIncomingDocApprovalsWorkflowEnabled;
        SendIncomingDocApprovalRequestVisible := IsIncomingDocApprovalsWorkflowEnabled;
      END;
    END;

    LOCAL PROCEDURE IsIncomingDocApprovalsWorkflowEnabled@30() : Boolean;
    VAR
      WorkflowEventHandling@1000 : Codeunit 1520;
      WorkflowDefinition@1005 : Query 1502;
    BEGIN
      WorkflowDefinition.SETRANGE(Table_ID,DATABASE::"Incoming Document");
      WorkflowDefinition.SETRANGE(Entry_Point,TRUE);
      WorkflowDefinition.SETRANGE(Enabled,TRUE);
      WorkflowDefinition.SETRANGE(Type,WorkflowDefinition.Type::"Event");
      WorkflowDefinition.SETRANGE(Function_Name,WorkflowEventHandling.RunWorkflowOnSendIncomingDocForApprovalCode);
      WorkflowDefinition.OPEN;
      WHILE WorkflowDefinition.READ DO
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CreateVendorFromTemplate@10();
    VAR
      MiniVendorTemplate@1001 : Record 1303;
      Vendor@1000 : Record 23;
    BEGIN
      IF NewMode THEN BEGIN
        IF MiniVendorTemplate.NewVendorFromTemplate(Vendor) THEN BEGIN
          COPY(Vendor);
          CurrPage.UPDATE;
        END;
        NewMode := FALSE;
      END;
    END;

    BEGIN
    END.
  }
}

